<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Cripto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        .loader {
            border-top-color: #22d3ee; /* cyan-400 */
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @-webkit-keyframes spinner {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .social-icon:hover {
            transform: scale(1.15);
            color: #22d3ee; /* cyan-400 */
        }
        .hidden {
            display: none;
        }
        #suggestions-list, #suggestions-flip-a, #suggestions-flip-b, #suggestions-goal {
            z-index: 10;
        }
        .bitcoin-icon {
            width: 1em;
            height: 1em;
            display: inline-block;
            vertical-align: middle;
            margin-left: 0.2em;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

<div class="container mx-auto p-4 md:p-8">
    <header class="text-center mb-8">
        <h1 class="text-4xl font-bold text-cyan-400 mb-2">Calculadora de Criptomonedas</h1>
        <p class="text-gray-400 max-w-2xl mx-auto">¬øPuede tu altcoin volver a su m√°ximo hist√≥rico? Esta herramienta calcula el market cap necesario considerando la inflaci√≥n de tokens.</p>
    </header>

    <div class="max-w-xl mx-auto mb-8">
        <div class="relative flex gap-2">
            <input type="text" id="searchInput" class="w-full bg-gray-800 border-2 border-gray-700 text-white rounded-lg px-4 py-3 focus:outline-none focus:border-cyan-500 transition-colors" placeholder="Busca una moneda (ej. Bitcoin, Ethereum)...">
            <button id="searchButton" class="bg-cyan-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-cyan-600 transition">Buscar</button>
        </div>
        <div id="suggestions-container" class="relative w-full">
            <ul id="suggestions-list" class="absolute z-20 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg hidden max-h-60 overflow-y-auto"></ul>
        </div>
        <p id="error-message" class="text-red-400 text-sm mt-2 text-center hidden"></p>
    </div>
    
    <div id="loader" class="loader ease-linear rounded-full border-8 border-t-8 border-gray-700 h-16 w-16 mx-auto my-8 hidden"></div>

    <div id="result" class="hidden">
        </div>

    <div class="mt-12 max-w-4xl mx-auto">
        <h2 class="text-2xl font-semibold text-center mb-6">Ejemplos Populares</h2>
        <div id="examples" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
            </div>
    </div>
    
    <section class="max-w-5xl mx-auto px-4 py-10 mt-16">
        <h2 class="text-3xl font-bold text-green-400 mb-4 text-center">Finanzas Tradicionales vs. Cripto: ¬øPor qu√© conviene? üöÄ</h2>
        <p class="text-gray-300 mb-6 text-center">¬øD√≥nde rinde m√°s tu dinero? Una comparativa directa.</p>
        
        <h3 class="text-xl font-semibold text-white mb-2">1. Rendimientos: Plazo Fijo en USD vs. Stablecoins</h3>
        <div class="overflow-x-auto mb-6">
            <table class="w-full text-left text-sm text-gray-300 border-collapse">
                <thead><tr class="bg-gray-700 text-cyan-400"><th class="p-2">CARACTER√çSTICA</th><th class="p-2">PLAZO FIJO BANCARIO (TRADFI)</th><th class="p-2">RENDIMIENTOS EN USDT/USDC (CRIPTO)</th></tr></thead>
                <tbody>
                    <tr class="border-t border-gray-600"><td class="p-2">Rendimiento Anual (APY)</td><td class="p-2">~0.1% a 3.5% en LATAM.</td><td class="p-2 text-green-400">~5% a 15% o m√°s.</td></tr>
                    <tr class="border-t border-gray-600"><td class="p-2">Flexibilidad</td><td class="p-2">Bloqueado. Retirar antes implica perder intereses.</td><td class="p-2">Total. Retiro en cualquier momento sin penalizaci√≥n.</td></tr>
                    <tr class="border-t border-gray-600"><td class="p-2">Acceso</td><td class="p-2">Requiere ser cliente, cumplir requisitos y montos m√≠nimos.</td><td class="p-2">Abierto a cualquier persona con una wallet.</td></tr>
                </tbody>
            </table>
        </div>

        <h3 class="text-xl font-semibold text-white mb-2 mt-8">2. Acceso al Cr√©dito: Pr√©stamos Bancarios vs. DeFi</h3>
        <div class="overflow-x-auto mb-6">
            <table class="w-full text-left text-sm text-gray-300 border-collapse">
                <thead><tr class="bg-gray-700 text-cyan-400"><th class="p-2">CARACTER√çSTICA</th><th class="p-2">PR√âSTAMO BANCARIO (TRADFI)</th><th class="p-2">PR√âSTAMO DESCENTRALIZADO (DEFI)</th></tr></thead>
                <tbody>
                    <tr class="border-t border-gray-600"><td class="p-2">Requisitos</td><td class="p-2">Historial crediticio, demostraci√≥n de ingresos, papeleo, etc.</td><td class="p-2">Tener criptomonedas como colateral. Nada m√°s.</td></tr>
                    <tr class="border-t border-gray-600"><td class="p-2">Proceso</td><td class="p-2">D√≠as o semanas de espera para aprobaci√≥n.</td><td class="p-2 text-green-400">En minutos, conectando tu wallet.</td></tr>
                    <tr class="border-t border-gray-600"><td class="p-2">Incentivos</td><td class="p-2">Ninguno.</td><td class="p-2">A menudo recibes recompensas en tokens por participar.</td></tr>
                </tbody>
            </table>
        </div>

        <h3 class="text-xl font-semibold text-white mb-2 mt-10">3. Poder Adquisitivo: D√≥lar vs. Bitcoin</h3>
        <p class="text-sm text-gray-400 mb-4">¬øQu√© se pod√≠a comprar con el mismo valor inicial a lo largo del tiempo?</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-gray-800 rounded-xl p-4"><h4 class="text-lg font-bold text-white mb-2">2010</h4><p class="text-sm text-gray-400">Con ~$40 se compraban un par de pizzas grandes.</p><p class="text-sm text-orange-400 mt-2">Con 10.000 BTC se compraban... un par de pizzas grandes.<img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="Bitcoin" class="bitcoin-icon"><img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="Bitcoin" class="bitcoin-icon"><img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="Bitcoin" class="bitcoin-icon"></p></div>
            <div class="bg-gray-800 rounded-xl p-4"><h4 class="text-lg font-bold text-white mb-2">2017</h4><p class="text-sm text-gray-400">Con ~$20.000 se compraba un auto nuevo.</p><p class="text-sm text-green-400 mt-2">Con ~1 BTC te comprabas el mismo auto nuevo.<img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="Bitcoin" class="bitcoin-icon"><img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="Bitcoin" class="bitcoin-icon"></p></div>
            <div class="bg-gray-800 rounded-xl p-4"><h4 class="text-lg font-bold text-white mb-2">Hoy</h4><p class="text-sm text-gray-400">Con ~$70.000 se compra un auto de gama alta.</p><p class="text-sm text-green-400 mt-2">Con 1 BTC te compras el mismo auto y te sobra para una casa.<img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="Bitcoin" class="bitcoin-icon"></p></div>
        </div>
    </section>

    <div id="advanced-section" class="mt-16 max-w-6xl mx-auto p-6 bg-gray-800/50 rounded-xl border border-gray-700">
        <h2 class="text-3xl font-bold text-center mb-2 text-cyan-400">Calculadora de Proyecciones Avanzadas</h2>
        <p class="text-gray-400 text-center mb-8">Calcula escenarios hipot√©ticos y el potencial real de tus inversiones.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-xl font-semibold mb-4 text-white">Simulador de "Flippening"</h3>
                <p class="text-sm text-gray-400 mb-4">Calcula a qu√© precio llegar√≠a una moneda si alcanzara el Market Cap de otra.</p>
                <div class="space-y-4">
                    <div class="relative"><label for="flip-coin-a" class="block text-sm font-medium text-gray-300">Si</label><input type="text" id="flip-coin-a" data-coin-id="" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="Ej: Cardano"><ul id="suggestions-flip-a" class="absolute z-10 w-full mt-1 bg-gray-600 border border-gray-500 rounded-lg hidden max-h-48 overflow-y-auto"></ul></div>
                    <div class="relative"><label for="flip-coin-b" class="block text-sm font-medium text-gray-300">Alcanzara el Market Cap de</label><input type="text" id="flip-coin-b" data-coin-id="" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="Ej: Ethereum"><ul id="suggestions-flip-b" class="absolute z-10 w-full mt-1 bg-gray-600 border border-gray-500 rounded-lg hidden max-h-48 overflow-y-auto"></ul></div>
                </div>
                <button id="calculate-flip" class="w-full mt-6 bg-cyan-500 text-white font-bold py-2 rounded-lg hover:bg-cyan-600 transition">Calcular Proyecci√≥n</button>
                <div id="flip-result" class="mt-4 text-center hidden"></div>
            </div>
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-xl font-semibold mb-4 text-white">Calculadora de Metas</h3>
                <p class="text-sm text-gray-400 mb-4">¬øQu√© Market Cap necesita tu moneda para alcanzar tu objetivo?</p>
                <div class="space-y-4">
                    <div class="flex items-center gap-2"><span class="text-gray-300">Si invierto</span><input type="number" id="goal-initial" class="w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="1000"></div>
                    <div class="relative"><label for="goal-coin" class="block text-sm font-medium text-gray-300">en</label><input type="text" id="goal-coin" data-coin-id="" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="Ej: Solana"><ul id="suggestions-goal" class="absolute z-10 w-full mt-1 bg-gray-600 border border-gray-500 rounded-lg hidden max-h-48 overflow-y-auto"></ul></div>
                    <div class="flex items-center gap-2"><span class="text-gray-300">y quiero que se conviertan en</span><input type="number" id="goal-target" class="w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="10000"></div>
                </div>
                <button id="calculate-goal" class="w-full mt-6 bg-cyan-500 text-white font-bold py-2 rounded-lg hover:bg-cyan-600 transition">Calcular Market Cap Necesario</button>
                <div id="goal-result" class="mt-4 text-center hidden"></div>
            </div>
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 md:col-span-2 lg:col-span-1">
                <h3 class="text-xl font-semibold mb-4 text-white">Calculadora de Rendimientos (Yield)</h3>
                <p class="text-sm text-gray-400 mb-4">Calcula cu√°nto podr√≠as generar en un a√±o.</p>
                <div class="space-y-4">
                    <div><label for="yield-amount" class="block text-sm font-medium text-gray-300">Monto a Invertir (USD)</label><input type="number" id="yield-amount" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="1000"></div>
                    <div>
                        <label for="yield-asset" class="block text-sm font-medium text-gray-300">Selecciona el Activo o Plataforma</label>
                        <select id="yield-asset" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2">
                            <option value="10">USDT - BingX (hasta $1000): 10% APY</option>
                            <option value="6.2">USDT - Bybit (hasta $200): 6.2% APY</option>
                            <option value="14">USDT - Nexo: hasta 14% APY</option>
                            <option value="6">BTC - Nexo: hasta 6% APY</option>
                            <option value="8">ETH - Nexo: hasta 8% APY</option>
                            <option value="4">Ethereum (Staking General): 4% APY</option>
                            <option value="2">Bitcoin (Rendimiento General): 2% APY</option>
                        </select>
                    </div>
                     <div>
                        <label for="yield-manual-apy" class="block text-sm font-medium text-gray-300">O introduce APY Manual (%):</label>
                        <input type="number" id="yield-manual-apy" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2" placeholder="Ej: 7.5">
                    </div>
                </div>
                <button id="calculate-yield" class="w-full mt-6 bg-cyan-500 text-white font-bold py-2 rounded-lg hover:bg-cyan-600 transition">Calcular Rendimiento Anual</button>
                <div id="yield-result" class="mt-4 text-center hidden"></div>
            </div>
        </div>
    </div>

    <div id="trading-tools-section" class="mt-16 max-w-6xl mx-auto p-6 bg-gray-800/50 rounded-xl border border-gray-700">
        <h2 class="text-3xl font-bold text-center mb-2 text-orange-400">Herramientas de Trading</h2>
        <p class="text-gray-400 text-center mb-8">Calcula tu gesti√≥n de riesgo de forma profesional.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-xl font-semibold mb-4 text-white">Calculadora de Lotaje (Forex)</h3>
                <p class="text-sm text-gray-400 mb-4">Define cu√°nto arriesgar por operaci√≥n seg√∫n tu capital y stop loss.</p>
                <div class="space-y-4">
                    <div><label for="lotaje-account-currency" class="block text-sm font-medium text-gray-300">Divisa de la Cuenta:</label><select id="lotaje-account-currency" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"><option value="USD">USD</option><option value="EUR">EUR</option></select></div>
                    <div>
                        <label for="lotaje-pair" class="block text-sm font-medium text-gray-300">Par de Divisas:</label>
                        <select id="lotaje-pair" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2">
                            <option value="EURUSD">EUR/USD</option>
                            <option value="GBPUSD">GBP/USD</option>
                            <option value="AUDUSD">AUD/USD</option>
                            <option value="USDJPY">USD/JPY</option>
                            <option value="USDCAD">USD/CAD</option>
                            <option value="USDCHF">USD/CHF</option>
                            <option value="EURJPY">EUR/JPY</option>
                            <option value="GBPJPY">GBP/JPY</option>
                        </select>
                    </div>
                    <div><label for="lotaje-account-size" class="block text-sm font-medium text-gray-300">Tama√±o de la Cuenta:</label><input type="number" id="lotaje-account-size" placeholder="Ej. 10000" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"></div>
                    <div><label for="lotaje-risk-ratio" class="block text-sm font-medium text-gray-300">Ratio de Riesgo %:</label><input type="number" id="lotaje-risk-ratio" placeholder="Ej. 1" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"></div>
                    <div><label for="lotaje-stop-loss" class="block text-sm font-medium text-gray-300">Detenci√≥n de P√©rdida (Pips):</label><input type="number" id="lotaje-stop-loss" placeholder="Ej. 20" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"></div>
                </div>
                <button id="lotaje-swap-button" class="w-full mt-6 bg-orange-500 text-white font-bold py-2 rounded-lg hover:bg-orange-600 transition">Calcular Lotaje</button>
                <div id="lotaje-result" class="mt-4 text-center hidden"></div>
            </div>
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-xl font-semibold mb-4 text-white">Calculadora de Liquidaci√≥n (Perpetuos)</h3>
                <p class="text-sm text-gray-400 mb-4">Calcula tu precio de liquidaci√≥n y stop loss sugerido.</p>
                <div class="space-y-4">
                     <div>
                        <label for="liq-pair" class="block text-sm font-medium text-gray-300">Par de Trading:</label>
                        <select id="liq-pair" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2">
                            <option value="BTC/USDT">BTC/USDT</option>
                            <option value="ETH/USDT">ETH/USDT</option>
                            <option value="SOL/USDT">SOL/USDT</option>
                            <option value="LTC/USDT">LTC/USDT</option>
                            <option value="LINK/USDT">LINK/USDT</option>
                            <option value="DOT/USDT">DOT/USDT</option>
                            <option value="BNB/USDT">BNB/USDT</option>
                            <option value="XRP/USDT">XRP/USDT</option>
                        </select>
                    </div>
                     <div>
                        <label for="liq-manual-pair" class="block text-sm font-medium text-gray-300">O Ingrese Par Manualmente:</label>
                        <input type="text" id="liq-manual-pair" placeholder="Ej: ADA/USDT" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2">
                    </div>
                    <div><label for="liq-leverage" class="block text-sm font-medium text-gray-300">Apalancamiento (ej: 10x, 20x):</label><input type="number" id="liq-leverage" placeholder="20" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"></div>
                    <div><label for="liq-direction" class="block text-sm font-medium text-gray-300">Direcci√≥n:</label><select id="liq-direction" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"><option value="long">Long</option><option value="short">Short</option></select></div>
                    <div><label for="liq-capital" class="block text-sm font-medium text-gray-300">Capital de la Cuenta (USD):</label><input type="number" id="liq-capital" placeholder="1000" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"></div>
                    <div><label for="liq-risk" class="block text-sm font-medium text-gray-300">Riesgo por Operaci√≥n (%):</label><input type="number" id="liq-risk" placeholder="2" class="mt-1 w-full bg-gray-700 border border-gray-600 rounded-md p-2"></div>
                </div>
                <button id="calculate-liquidation" class="w-full mt-6 bg-orange-500 text-white font-bold py-2 rounded-lg hover:bg-orange-600 transition">Calcular Riesgo</button>
                <div id="liquidation-result" class="mt-4 text-center hidden"></div>
                <div id="liquidation-chart" class="mt-6 hidden">
                    <p class="text-center text-sm mb-2">Visualizaci√≥n de Riesgo</p>
                    <div class="relative h-48 bg-gray-700/50 rounded-lg p-2 border border-gray-600">
                        <div id="liq-level-line" class="absolute left-0 right-0 border-t-2 border-dashed border-red-500"><span class="text-xs text-red-500 bg-gray-800 px-1 rounded">Liquidaci√≥n</span></div>
                        <div id="sl-level-line" class="absolute left-0 right-0 border-t-2 border-dashed border-yellow-500"><span class="text-xs text-yellow-500 bg-gray-800 px-1 rounded">Stop Loss Sugerido</span></div>
                        <div class="absolute left-0 right-0 top-1/2 border-t border-solid border-green-500"><span class="text-xs text-green-500 bg-gray-800 px-1 rounded">Entrada</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="referrals-section" class="mt-16 max-w-4xl mx-auto p-6 bg-gray-800/50 rounded-xl border border-gray-700">
       <h2 class="text-3xl font-bold text-center mb-2 text-cyan-400">Exchanges de Confianza</h2>
       <p class="text-gray-400 text-center mb-8">LCA opera con los siguientes exchanges, que son de nuestra confianza. Usa nuestros links para registrarte.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-gray-800 rounded-lg p-6 flex flex-col items-center text-center border border-gray-700"><img src="https://upload.wikimedia.org/wikipedia/commons/5/57/BingX_logo.svg" alt="BingX Logo" class="h-16 mb-4 p-1"><h3 class="text-xl font-bold">BingX</h3><p class="text-sm text-gray-400 mt-2 flex-grow">Ideal para operar cripto en spot, futuros y obtener rendimientos interesantes con tus stablecoins.</p><a href="https://bingx.com/en/accounts/invite/NZP9WN" target="_blank" rel="noopener noreferrer" class="w-full mt-4 bg-blue-500 text-white font-bold py-2 rounded-lg hover:bg-blue-600 transition">Registrarse en BingX</a></div>
            <div class="bg-gray-800 rounded-lg p-6 flex flex-col items-center text-center border border-gray-700"><img src="https://upload.wikimedia.org/wikipedia/commons/f/f2/Bybit_logo.svg" alt="Bybit Logo" class="h-16 w-16 mb-4 object-contain p-1"><h3 class="text-xl font-bold">Bybit</h3><p class="text-sm text-gray-400 mt-2 flex-grow">Uno de los exchanges m√°s grandes y con mayor liquidez del mercado. Excelente para trading avanzado.</p><a href="https://partner.bybit.com/b/lcaitech" target="_blank" rel="noopener noreferrer" class="w-full mt-4 bg-yellow-500 text-black font-bold py-2 rounded-lg hover:bg-yellow-600 transition">Registrarse en Bybit</a></div>
            <div class="bg-gray-800 rounded-lg p-6 flex flex-col items-center text-center border border-gray-700"><img src="https://upload.wikimedia.org/wikipedia/commons/4/44/OKX_Logo.svg" alt="OKX Logo" class="h-16 mb-4 p-2"><h3 class="text-xl font-bold">OKX</h3><p class="text-sm text-gray-400 mt-2 flex-grow">Plataforma robusta con una amplia variedad de criptomonedas y productos de inversi√≥n.</p><a href="https://www.okx.com/join/3269705" target="_blank" rel="noopener noreferrer" class="w-full mt-4 bg-black text-white font-bold py-2 rounded-lg hover:bg-gray-800 transition">Registrarse en OKX</a></div>
            <div class="bg-gray-800 rounded-lg p-6 flex flex-col items-center text-center border border-gray-700"><img src="https://cryptologos.cc/logos/nexo-nexo-logo.svg?v=032" alt="Nexo Logo" class="h-16 mb-4 rounded-full bg-white p-2"><h3 class="text-xl font-bold">Nexo</h3><ul class="text-sm text-gray-300 mt-2 flex-grow list-disc list-inside text-left"><li>Hasta <span class="font-bold">14%</span> en USDC</li><li>Hasta <span class="font-bold">7%</span> en Bitcoin</li><li>Hasta <span class="font-bold">8%</span> en Ethereum</li></ul><p class="text-xs text-gray-500 mt-1">(Depositando m√°s de $5000)</p><a href="https://nexo.com/ref/jt1cgk3tjr?src=web-link" target="_blank" rel="noopener noreferrer" class="w-full mt-4 bg-indigo-500 text-white font-bold py-2 rounded-lg hover:bg-indigo-600 transition">Registrarse en Nexo</a></div>
        </div>
    </div>

    <div class="mt-16 max-w-4xl mx-auto text-center p-6 bg-gray-800/50 rounded-xl border border-gray-700">
        <h2 class="text-2xl font-semibold text-green-400">Apoya el Proyecto</h2>
        <p class="text-gray-400 mt-2 mb-4 max-w-xl mx-auto">Si esta herramienta te resulta √∫til, considera hacer un donativo. Tus aportes se usar√°n para mejorar la app y a√±adir nuevas funciones.</p>
        <div class="bg-gray-900/70 p-4 rounded-lg max-w-lg mx-auto">
            <p class="text-sm text-gray-300">Direcci√≥n (BEP20, ETH, etc.):</p>
            <div class="flex items-center justify-between gap-4 mt-2">
                <code id="walletAddress" class="text-xs md:text-sm text-amber-300 break-all">0x1234567890abcdef1234567890abcdef12345678</code>
                <button id="copyButton" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-3 rounded-lg text-sm transition">Copiar</button>
            </div>
            <p id="copy-feedback" class="text-green-400 text-xs mt-2 hidden">¬°Direcci√≥n copiada!</p>
        </div>
        <p class="text-xs text-gray-500 mt-3">Red recomendada: BEP20 (BSC)</p>
    </div>

    <div class="mt-16 max-w-4xl mx-auto text-center">
        <h2 class="text-xl font-semibold text-white">¬øEncontraste un error o tienes una sugerencia?</h2>
        <p class="text-gray-400 mt-2 mb-4">Tu feedback nos ayuda a mejorar. ¬°Cont√°ctanos directamente en nuestro Telegram!</p>
        <a href="https://t.me/LCAITECH_OFICIAL" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-3 bg-blue-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition shadow-lg">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0011.944 0zm5.663 7.258l-1.455 6.822a.763.763 0 01-1.446.417l-2.43-1.823-1.168 1.127a.488.488 0 01-.39.155.54.54 0 01-.368-.142l.002-.001-1.89-1.72-3.79-1.422a.749.749 0 01.127-1.42l11.164-4.32a.759.759 0 01.977.91z"/></svg>
            Reportar un Error / Feedback
        </a>
    </div>
</div>

<footer class="text-center p-4 mt-12 border-t border-gray-800">
    <p class="text-gray-500 text-sm">Proyecto creado por <strong class="font-semibold text-gray-400">LCA ITECH</strong></p>
    <div class="flex justify-center items-center space-x-6 mt-4">
        <a href="https://x.com/LCA_ITECH" target="_blank" rel="noopener noreferrer" class="text-gray-400 transition-all duration-300 social-icon" aria-label="Twitter"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
        <a href="https://www.instagram.com/learncryptoacademy/" target="_blank" rel="noopener noreferrer" class="text-gray-400 transition-all duration-300 social-icon" aria-label="Instagram"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.024.06 1.378.06 3.808s-.012 2.784-.06 3.808c-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.024.048-1.378.06-3.808.06s-2.784-.013-3.808-.06c-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.048-1.024-.06-1.378-.06-3.808s.012-2.784.06-3.808c.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 016.08 2.525c.636-.247 1.363-.416 2.427-.465C9.53 2.013 9.884 2 12.315 2zm-1.04 17.59c1.442 0 2.625-1.183 2.625-2.625s-1.183-2.625-2.625-2.625-2.625 1.183-2.625 2.625 1.183 2.625 2.625 2.625zm1.905-10.056a1.219 1.219 0 10-2.438 0 1.219 1.219 0 002.438 0zM12 6.845a5.455 5.455 0 100 10.91 5.455 5.455 0 000-10.91z" clip-rule="evenodd"/></svg></a>
        <a href="https://t.me/LCAITECH_OFICIAL" target="_blank" rel="noopener noreferrer" class="text-gray-400 transition-all duration-300 social-icon" aria-label="Telegram"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0011.944 0zm5.663 7.258l-1.455 6.822a.763.763 0 01-1.446.417l-2.43-1.823-1.168 1.127a.488.488 0 01-.39.155.54.54 0 01-.368-.142l.002-.001-1.89-1.72-3.79-1.422a.749.749 0 01.127-1.42l11.164-4.32a.759.759 0 01.977.91z"/></svg></a>
    </div>
    <p class="text-gray-600 text-xs mt-4">Datos de precios proporcionados por CoinGecko API.</p>
</footer>

<script>
    const ui = {
        searchInput: document.getElementById('searchInput'),
        searchButton: document.getElementById('searchButton'),
        suggestions: document.getElementById('suggestions-list'),
        result: document.getElementById('result'),
        examples: document.getElementById('examples'),
        loader: document.getElementById('loader'),
        errorMessage: document.getElementById('error-message'),
        flip: {
            coinA: document.getElementById('flip-coin-a'),
            suggestionsA: document.getElementById('suggestions-flip-a'),
            coinB: document.getElementById('flip-coin-b'),
            suggestionsB: document.getElementById('suggestions-flip-b'),
            button: document.getElementById('calculate-flip'),
            result: document.getElementById('flip-result'),
        },
        goal: {
            initial: document.getElementById('goal-initial'),
            coin: document.getElementById('goal-coin'),
            suggestions: document.getElementById('suggestions-goal'),
            target: document.getElementById('goal-target'),
            button: document.getElementById('calculate-goal'),
            result: document.getElementById('goal-result'),
        },
        yield: {
            amount: document.getElementById('yield-amount'),
            asset: document.getElementById('yield-asset'),
            manualApy: document.getElementById('yield-manual-apy'),
            button: document.getElementById('calculate-yield'),
            result: document.getElementById('yield-result'),
        },
        lotaje: {
            accountCurrency: document.getElementById('lotaje-account-currency'),
            pair: document.getElementById('lotaje-pair'),
            accountSize: document.getElementById('lotaje-account-size'),
            riskRatio: document.getElementById('lotaje-risk-ratio'),
            stopLoss: document.getElementById('lotaje-stop-loss'),
            swapButton: document.getElementById('lotaje-swap-button'),
            result: document.getElementById('lotaje-result'),
        },
        liquidation: {
            pair: document.getElementById('liq-pair'),
            manualPair: document.getElementById('liq-manual-pair'),
            leverage: document.getElementById('liq-leverage'),
            direction: document.getElementById('liq-direction'),
            capital: document.getElementById('liq-capital'),
            risk: document.getElementById('liq-risk'),
            button: document.getElementById('calculate-liquidation'),
            result: document.getElementById('liquidation-result'),
            chart: document.getElementById('liquidation-chart'),
            liqLine: document.getElementById('liq-level-line'),
            slLine: document.getElementById('sl-level-line'),
        },
        copyButton: document.getElementById('copyButton'),
        copyFeedback: document.getElementById('copy-feedback'),
        walletAddress: document.getElementById('walletAddress')
    };

    const popularCoins = [
        { id: 'bitcoin', name: 'Bitcoin', logo: 'https://assets.coingecko.com/coins/images/1/large/bitcoin.png?1696501400' },
        { id: 'ethereum', name: 'Ethereum', logo: 'https://assets.coingecko.com/coins/images/279/large/ethereum.png?1696501638' },
        { id: 'solana', name: 'Solana', logo: 'https://assets.coingecko.com/coins/images/4128/large/solana.png?1696504756' },
        { id: 'chainlink', name: 'Chainlink', logo: 'https://assets.coingecko.com/coins/images/877/large/chainlink-new-logo.png?1696502009' },
        { id: 'polkadot', name: 'Polkadot', logo: 'https://assets.coingecko.com/coins/images/12171/large/polkadot.png?1696512008' },
        { id: 'binancecoin', name: 'BNB', logo: 'https://assets.coingecko.com/coins/images/825/large/bnb-icon2_2x.png?1696501970' },
        { id: 'dogecoin', name: 'Dogecoin', logo: 'https://assets.coingecko.com/coins/images/5/large/dogecoin.png?1696501409' },
        { id: 'shiba-inu', name: 'Shiba Inu', logo: 'https://assets.coingecko.com/coins/images/11939/large/shiba.png?1696511800' },
        { id: 'ripple', name: 'XRP', logo: 'https://assets.coingecko.com/coins/images/44/large/xrp-symbol-white-128.png?1696501442' },
        { id: 'uniswap', name: 'Uniswap', logo: 'https://assets.coingecko.com/coins/images/12504/large/uniswap-uni.png?1696512319' }
    ];

    // Base de datos local con datos hist√≥ricos precisos
    const historicalData = {
        'ethereum': { athPrice: 4878.26, historicalAthMarketCap: 573390000000, athSupply: 118290000 },
        'solana': { athPrice: 293.31, historicalAthMarketCap: 88387000000, athSupply: 301210000 },
        'chainlink': { athPrice: 53.13, historicalAthMarketCap: 19200000000, athSupply: 420000000 },
        'polkadot': { athPrice: 55.13, historicalAthMarketCap: 48500000000, athSupply: 897600000 },
        'uniswap': { athPrice: 44.97, historicalAthMarketCap: 23500000000, athSupply: 560000000 }
    };

    let coinList = [], searchTimeout;
    const uiState = { show: e => e.classList.remove("hidden"), hide: e => e.classList.add("hidden"), showError: (e, t = ui.errorMessage) => { t.textContent = e, uiState.show(t) }, hideError: (e = ui.errorMessage) => uiState.hide(e), showLoader: () => { uiState.show(ui.loader), uiState.hide(ui.result), uiState.hideError() }, hideLoader: () => uiState.hide(ui.loader) };

    async function getCoinList() { if (0 < coinList.length) return; try { const e = await fetch("https://api.coingecko.com/api/v3/coins/list?include_platform=false"); if (!e.ok) throw new Error(`Error en la API: ${e.status}`); coinList = await e.json() } catch (e) { console.error("Error al obtener la lista de monedas:", e), uiState.showError("No se pudo cargar la lista de monedas. La b√∫squeda no funcionar√°.") } }
    function getRankedMatches(e) { const t = e.toLowerCase().trim(); return t.length < 1 ? [] : coinList.map(e => { const n = e.name.toLowerCase(), a = e.symbol.toLowerCase(); let o = 0; return a === t ? o = 100 : n === t ? o = 90 : n.startsWith(t) ? o = 80 : a.startsWith(t) ? o = 70 : n.includes(t) ? o = 20 : a.includes(t) && (o = 10), { ...e, score: o } }).filter(e => e.score > 0).sort((e, t) => t.score - e.score) }
    function showSuggestions(e, t, n) { const a = getRankedMatches(e); if (n.innerHTML = "", a.length > 0) { a.slice(0, 5).forEach(e => { const a = document.createElement("li"); a.className = "px-4 py-2 hover:bg-gray-700 cursor-pointer", a.textContent = `${e.name} (${e.symbol.toUpperCase()})`, a.onmousedown = () => { t.value = e.name, t.dataset.coinId = e.id, uiState.hide(n), t === ui.searchInput && fetchMainCoinData(e.id) }, n.appendChild(a) }), uiState.show(n) } else uiState.hide(n) }
    async function triggerSearch() { const e = ui.searchInput.value.toLowerCase().trim(); if (e.length === 0) return; if (coinList.length === 0 && (await getCoinList(), coinList.length === 0)) return void uiState.showError("La lista de monedas no est√° disponible, no se puede buscar."); const t = getRankedMatches(e); t.length > 0 ? (uiState.hide(ui.suggestions), ui.searchInput.value = "", fetchMainCoinData(t[0].id)) : uiState.showError(`No se encontr√≥ ninguna moneda que coincida con "${e}".`) }
    async function getCoinDataById(e, t = 2) { if (!e) return null; for (let n = 0; n < t; n++) try { const a = `https://api.coingecko.com/api/v3/coins/${e}?localization=false&tickers=false&market_data=true&community_data=false&developer_data=false`, o = await fetch(a); if (!o.ok) { if (n < t - 1 && 429 === o.status) await new Promise(e => setTimeout(e, 2e3 * (n + 1))); else continue } return await o.json() } catch (a) { if (n < t - 1) await new Promise(e => setTimeout(e, 2e3 * (n + 1))); else continue } return null }
    async function fetchMainCoinData(e) { uiState.showLoader(); const t = await getCoinDataById(e); t ? calculateAndDisplay(t) : (uiState.showError("No se pudieron obtener los datos para la moneda seleccionada."), uiState.hideLoader()) }

    function calculateAndDisplay(apiData) {
        try {
            const coinId = apiData.id;
            const marketData = apiData.market_data || {};
            
            // Usar datos hardcoded si existen, si no, usar los de la API
            const customData = historicalData[coinId];
            const athPrice = customData ? customData.athPrice : marketData.ath?.usd;
            const currentSupply = marketData.circulating_supply || 0;
            const currentMarketCap = marketData.market_cap?.usd || null;
            const currentPrice = marketData.current_price?.usd || 0;
            const athDate = marketData.ath_date?.usd ? new Date(marketData.ath_date.usd).toLocaleDateString("es-ES") : "N/A";
            
            if (!athPrice || !currentMarketCap) {
                throw new Error(`Datos de Market Cap o ATH no disponibles en la API para ${apiData.name}.`);
            }

            // Calcular el Market Cap necesario para alcanzar el precio ATH con el supply actual
            const requiredMarketCapForAthPrice = athPrice * currentSupply;
            const percentageIncrease = currentMarketCap > 0 ? (requiredMarketCapForAthPrice / currentMarketCap - 1) * 100 : 0;
            
            let estimatedPriceAtAthMarketCap = null;
            let inflationPercentage = null;

            if (customData) {
                estimatedPriceAtAthMarketCap = customData.historicalAthMarketCap / currentSupply;
                inflationPercentage = ((currentSupply - customData.athSupply) / customData.athSupply) * 100;
            }

            displayResult({
                name: apiData.name,
                symbol: apiData.symbol.toUpperCase(),
                image: apiData.image?.large,
                athPrice,
                athDate,
                currentPrice,
                currentMarketCap,
                requiredMarketCap: requiredMarketCapForAthPrice,
                percentageIncrease,
                estimatedPriceAtAthMarketCap,
                inflationPercentage
            });

        } catch (error) {
            console.error("Error al calcular:", error);
            uiState.showError(error.message);
            displayPartialResult(apiData);
            uiState.hideLoader();
        }
    }

    function displayResult(data) {
        const { name, symbol, image, athPrice, currentPrice, athDate, currentMarketCap, requiredMarketCap, percentageIncrease, estimatedPriceAtAthMarketCap, inflationPercentage } = data;
        const increaseColor = percentageIncrease > 0 ? (percentageIncrease < 500 ? 'text-green-400' : (percentageIncrease < 2000 ? 'text-yellow-400' : 'text-red-500')) : 'text-gray-400';
        let message = "No se requiere aumento de Market Cap.";
        if (percentageIncrease > 2000) { message = "Es muy dif√≠cil que la moneda vuelva al ATH debido al alto aumento de capitalizaci√≥n necesario."; } 
        else if (percentageIncrease > 500) { message = "Es poco probable volver al ATH a corto plazo, pero posible si el inter√©s inversor es muy alto."; } 
        else if (percentageIncrease > 0) { message = "La moneda puede volver a su precio ATH con ciertas condiciones de mercado favorables."; }
        
        const estimatedPriceMessage = estimatedPriceAtAthMarketCap ? `Precio estimado si recupera el Market Cap de ATH: ${formatCurrency(estimatedPriceAtAthMarketCap, estimatedPriceAtAthMarketCap > 1 ? 2 : 8)}` : '';
        const inflationMessage = inflationPercentage ? `Inflaci√≥n estimada desde ATH: ${inflationPercentage.toFixed(2)}%` : '';

        ui.result.innerHTML = `<div class="bg-gray-800 rounded-xl shadow-lg p-6 md:p-8 max-w-4xl mx-auto border border-gray-700"><div class="flex flex-col md:flex-row items-center gap-6 mb-8"><img src="${image||"https://via.placeholder.com/80"}" alt="${name} logo" class="w-20 h-20 rounded-full bg-gray-700 p-2"><div><h2 class="text-3xl font-bold text-white">${name} <span class="text-gray-400 text-2xl">${symbol}</span></h2><p class="text-lg text-gray-300">Precio Actual: <span class="font-semibold text-cyan-400">${formatCurrency(currentPrice,currentPrice>1?2:8)}</span></p></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"><div class="bg-gray-700/50 p-4 rounded-lg"><h3 class="text-sm font-medium text-gray-400 mb-1">M√°ximo Hist√≥rico (Precio)</h3><p class="text-2xl font-semibold text-white">${formatCurrency(athPrice,athPrice>1?2:8)}</p><p class="text-xs text-gray-500">Alcanzado el ${athDate}</p></div><div class="bg-gray-700/50 p-4 rounded-lg"><h3 class="text-sm font-medium text-gray-400 mb-1">Market Cap Actual</h3><p class="text-2xl font-semibold text-white">${formatCompact(currentMarketCap)}</p></div></div><div class="bg-gradient-to-br from-cyan-500/10 to-blue-500/10 p-6 rounded-xl border border-cyan-500/30 text-center"><h3 class="text-lg font-medium text-cyan-300 mb-2">Para alcanzar el PRECIO de ATH, ${name} necesita:</h3><p class="text-5xl font-bold ${increaseColor} mt-4">${formatCompact(requiredMarketCap)}</p><p class="text-base text-gray-300 mb-4 mt-2">de Capitalizaci√≥n de Mercado (Market Cap)</p><div class="mt-4 bg-gray-900/50 rounded-lg p-2 inline-block"><p class="text-xs text-gray-400">Aumento necesario del Market Cap:</p><p class="text-xl font-bold ${increaseColor}">${isFinite(percentageIncrease)?(percentageIncrease>0?"+":"")+percentageIncrease.toFixed(2)+"%":"N/A"}</p></div><p class="text-sm ${increaseColor} mt-4">${message}</p><p class="text-xs text-gray-400 mt-2">${estimatedPriceMessage} ${inflationMessage}</p><button id="shareButton" class="mt-6 bg-cyan-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-cyan-600 transition">Compartir</button></div></div>`;
        uiState.show(ui.result);
        const shareButton = document.getElementById("shareButton");
        if(shareButton) shareButton.addEventListener("click",()=>{const e=`¬°An√°lisis de ${name} (${symbol}) en la Calculadora ATH!\nPrecio Actual: ${formatCurrency(currentPrice)}\nATH: ${formatCurrency(athPrice)}\nMC Actual: ${formatCompact(currentMarketCap)}\nMC Necesario p/ ATH: ${formatCompact(requiredMarketCap)} (+${percentageIncrease.toFixed(2)}%)\n\n${message}\n\nVer en: https://lca-crypto-calculator.netlify.app/`;navigator.share?navigator.share({title:`${name} - An√°lisis de ATH`,text:e,url:"https://lca-crypto-calculator.netlify.app/"}).catch(e=>console.error("Error sharing:",e)):navigator.clipboard.writeText(e).then(()=>alert("¬°Resultados copiados al portapapeles!")).catch(e=>console.error("Error copying:",e))});
    }

    function displayPartialResult(e) { const { market_data: t = {}, name: n = "Desconocido", symbol: a = "UNK", image: o = { large: "" } } = e, i = t.current_price?.usd || 0, s = t.market_cap?.usd || null, r = t.ath?.usd || 0, l = t.ath_date?.usd ? new Date(t.ath_date.usd).toLocaleDateString("es-ES") : "N/A"; ui.result.innerHTML = `<div class="bg-gray-800 rounded-xl p-6 max-w-4xl mx-auto border border-gray-700"><div class="flex items-center gap-6 mb-6"><img src="${o.large||"https://via.placeholder.com/80"}" alt="${n} logo" class="w-20 h-20 rounded-full"><div class="text-left"><h2 class="text-2xl font-bold">${n}</h2><p class="text-lg text-gray-400">${a}</p></div></div><p class="text-lg">Precio Actual: <span class="font-semibold text-cyan-400">${formatCurrency(i,8)}</span></p><div class="grid md:grid-cols-2 gap-6 mt-4"><div class="bg-gray-700/50 p-4 rounded-lg"><h3 class="text-sm text-gray-400">M√°ximo Hist√≥rico (Precio)</h3><p class="text-2xl font-semibold">${formatCurrency(r,8)}</p><p class="text-xs text-gray-500">Alcanzado el ${l}</p></div><div class="bg-gray-700/50 p-4 rounded-lg"><h3 class="text-sm text-gray-400">Market Cap Actual</h3><p class="text-2xl font-semibold">${s?formatCompact(s):"N/A"}</p></div></div><div class="mt-6 p-6 rounded-xl bg-yellow-500/10 border border-yellow-500/30 text-center"><p class="text-sm text-yellow-400">La API no provey√≥ todos los datos para esta moneda. Los resultados pueden no estar disponibles.</p></div></div>`, uiState.show(ui.result) }
    const formatCurrency=(e,t=2)=>e?new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD",maximumFractionDigits:t}).format(e):"N/A",formatCompact=e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",compactDisplay:"long"}).format(e):"N/A";
    function populateExamples(){ui.examples.innerHTML="",popularCoins.forEach(e=>{const t=document.createElement("button");t.className="bg-gray-800 border border-gray-700 p-3 rounded-lg flex flex-col items-center justify-center gap-2 hover:bg-gray-700 hover:border-cyan-500 transition duration-300",t.onclick=()=>fetchMainCoinData(e.id),t.innerHTML=`<img src="${e.logo}" alt="${e.name} logo" class="w-10 h-10"><span class="text-sm font-medium text-white">${e.name}</span>`,ui.examples.appendChild(t)})}
    async function handleFlipCalculation(){const e=ui.flip.coinA.dataset.coinId,t=ui.flip.coinB.dataset.coinId,n=ui.flip.result;if(!e||!t)return n.innerHTML='<p class="text-red-400">Selecciona ambas monedas.</p>',void uiState.show(n);n.innerHTML='<div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-6 w-6 mx-auto"></div>',uiState.show(n);const[a,o]=await Promise.all([getCoinDataById(e),getCoinDataById(t)]);if(!a||!o)return void(n.innerHTML='<p class="text-red-400">No se pudieron obtener datos.</p>');const i=a.market_data?.circulating_supply||0,s=o.market_data?.market_cap?.usd||0;0<i&&0<s?n.innerHTML=`<p class="text-gray-300">El precio de ${a.name} ser√≠a <span class="text-2xl font-bold text-cyan-400 block">${formatCurrency(s/i,8)}</span></p>`:n.innerHTML='<p class="text-red-400">Datos insuficientes.</p>'}
    async function handleGoalCalculation(){const e=parseFloat(ui.goal.initial.value)||0,t=parseFloat(ui.goal.target.value)||0,n=ui.goal.coin.dataset.coinId,a=ui.goal.result;if(!n||e<=0||t<=e)return a.innerHTML='<p class="text-red-400">Valores inv√°lidos.</p>',void uiState.show(a);a.innerHTML='<div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-6 w-6 mx-auto"></div>',uiState.show(a);const o=await getCoinDataById(n);if(!o)return void(a.innerHTML='<p class="text-red-400">No se pudo obtener datos.</p>');const i=o.market_data?.current_price?.usd||0,s=o.market_data?.circulating_supply||0;0<i&&0<s?a.innerHTML=`<p class="text-gray-300 text-sm">Para un ${(t/e).toFixed(1)}x, ${o.name} necesita:</p><p class="text-xl font-bold text-cyan-400">${formatCompact(i*(t/e)*s)}</p><p class="text-gray-400 text-xs">(Precio objetivo: ${formatCurrency(i*(t/e),8)})</p>`:a.innerHTML='<p class="text-red-400">Datos insuficientes.</p>'}
    function handleYieldCalculation(){const e=parseFloat(ui.yield.amount.value)||0,t=parseFloat(ui.yield.manualApy.value),n=ui.yield.result,a=!isNaN(t)&&0<t?t:parseFloat(ui.yield.asset.value)||0;if(e<=0||a<=0)return n.innerHTML='<p class="text-red-400">Ingresa un monto y un APY v√°lido.</p>',void uiState.show(n);const o=e*(a/100),i=e*(Math.pow(1+a/100/365,365)-1);n.innerHTML=`<div class="space-y-3"><div><p class="text-gray-300 text-sm">Ganancia (Inter√©s Simple - APR):</p><p class="text-lg font-bold text-green-400">${formatCurrency(o)}</p></div><div><p class="text-gray-300 text-sm">Ganancia (Inter√©s Compuesto - APY):</p><p class="text-xl font-bold text-green-300">${formatCurrency(i)}</p></div><p class="text-xs text-gray-500 pt-2">C√°lculo a 1 a√±o. No incluye fluctuaciones.</p></div>`,uiState.show(n)}
    function handleLotajeCalculation(){const e=ui.lotaje.pair.value,t=parseFloat(ui.lotaje.accountSize.value)||0,n=parseFloat(ui.lotaje.riskRatio.value)||0,a=parseFloat(ui.lotaje.stopLoss.value)||0,o=ui.lotaje.result;if(t<=0||n<=0||a<=0)return o.innerHTML='<p class="text-red-400">Valores inv√°lidos.</p>',void uiState.show(o);const i=e.includes("JPY")?1e-3:.0001,s=t*(n/100),r=s/(a*i);o.innerHTML=`<p class="text-gray-300">Monto a Arriesgar: <span class="text-lg font-bold text-cyan-400">${formatCurrency(s)}</span></p><p class="text-gray-300 mt-2">Tama√±o del Lote Sugerido: <span class="text-2xl font-bold text-orange-400 block mt-1">${(r/1e5).toFixed(2)}</span> lotes</p>`,uiState.show(o)}
    function handleLiquidationCalculation(){const e=parseFloat(ui.liquidation.leverage.value)||0,t=ui.liquidation.direction.value,n=parseFloat(ui.liquidation.capital.value)||0,a=parseFloat(ui.liquidation.risk.value)||0,o=ui.liquidation.result,i=ui.liquidation.chart;if(e<=0||n<=0||a<=0)return o.innerHTML='<p class="text-red-400">Valores inv√°lidos.</p>',uiState.show(o),void uiState.hide(i);const s=100/e,r=n*(a/100),l=a/e;o.innerHTML=`<p class="text-gray-300">Movimiento para liquidaci√≥n: <span class="text-xl font-bold text-red-500">${s.toFixed(2)}%</span> ${"long"===t?"a la baja":"al alza"}.</p><p class="text-gray-300 mt-2">Monto a arriesgar: <span class="text-lg font-bold text-cyan-400">${formatCurrency(r)}</span>.</p><p class="text-gray-400 text-sm mt-1">Stop Loss sugerido a <span class="font-bold text-yellow-500">${l.toFixed(2)}%</span> de distancia de la entrada.</p>`;const c=ui.liquidation.liqLine,d=ui.liquidation.slLine;"long"===t?(c.style.top=`${50+Math.min(s,48)}%`,d.style.top=`${50+Math.min(l,48)}%`):(c.style.top=`${50-Math.min(s,48)}%`,d.style.top=`${50-Math.min(l,48)}%`),uiState.show(o),uiState.show(i)}
    function handleCopyAddress(){const e=ui.walletAddress.textContent;navigator.clipboard.writeText(e).then(()=>{ui.copyFeedback.textContent="¬°Direcci√≥n copiada!",uiState.show(ui.copyFeedback),setTimeout(()=>{uiState.hide(ui.copyFeedback)},2e3)}).catch(e=>{console.error("Error al copiar:",e)})}
    
    document.addEventListener("DOMContentLoaded",()=>{
        populateExamples();
        getCoinList();
        
        document.addEventListener("click",function(e){document.querySelectorAll('[id$="-list"], [id^="suggestions-"]').forEach(t=>{const n=t.parentElement;n&&!n.contains(e.target)&&uiState.hide(t)})});
        
        const setupSearch=(t,n)=>{t&&t.addEventListener("input",e=>{clearTimeout(searchTimeout);const a=e.target.value;searchTimeout=setTimeout(()=>showSuggestions(a,t,n),300)})};
        setupSearch(ui.searchInput,ui.suggestions);
        setupSearch(ui.flip.coinA,ui.flip.suggestionsA);
        setupSearch(ui.flip.coinB,ui.flip.suggestionsB);
        setupSearch(ui.goal.coin,ui.goal.suggestions);

        if(ui.searchButton) ui.searchButton.addEventListener("click",triggerSearch);
        if(ui.searchInput) ui.searchInput.addEventListener("keydown",e=>{if(e.key==="Enter"){e.preventDefault();triggerSearch()}});
        if(ui.flip.button) ui.flip.button.addEventListener("click",handleFlipCalculation);
        if(ui.goal.button) ui.goal.button.addEventListener("click",handleGoalCalculation);
        if(ui.yield.button) ui.yield.button.addEventListener("click",handleYieldCalculation);
        if(ui.copyButton) ui.copyButton.addEventListener("click",handleCopyAddress);
        if(ui.lotaje.swapButton) ui.lotaje.swapButton.addEventListener("click",handleLotajeCalculation);
        if(ui.liquidation.button) ui.liquidation.button.addEventListener("click",handleLiquidationCalculation);
    });
</script>

</body>
</html>